<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DSAN-5000: Project – Unsupervised Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/gu-logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">DSAN-5000: Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../report/report.html"> 
<span class="menu-text">Report</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-technical-details" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Technical details</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-technical-details">    
        <li>
    <a class="dropdown-item" href="../../technical-details/data-collection/main.html">
 <span class="dropdown-text">Data-collection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../technical-details/data-cleaning/main.html">
 <span class="dropdown-text">Data-cleaning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../technical-details/eda/main.html">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../technical-details/unsupervised-learning/main.html">
 <span class="dropdown-text">Unsupervised Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../technical-details/supervised-learning/main.html">
 <span class="dropdown-text">Supervised Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../technical-details/progress-log.html">
 <span class="dropdown-text">Progress Log</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../technical-details/llm-usage-log.html">
 <span class="dropdown-text">LLM usage Log</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-and-motivation" id="toc-introduction-and-motivation" class="nav-link active" data-scroll-target="#introduction-and-motivation">Introduction and Motivation:</a></li>
  <li><a href="#overview-of-methods" id="toc-overview-of-methods" class="nav-link" data-scroll-target="#overview-of-methods">Overview of Methods</a></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code">Code</a>
  <ul class="collapse">
  <li><a href="#part-1-dimensionality-reduction" id="toc-part-1-dimensionality-reduction" class="nav-link" data-scroll-target="#part-1-dimensionality-reduction">Part 1: Dimensionality Reduction</a></li>
  <li><a href="#part-2-clustering-methods" id="toc-part-2-clustering-methods" class="nav-link" data-scroll-target="#part-2-clustering-methods">Part 2: Clustering Methods</a></li>
  </ul></li>
  <li><a href="#summary-and-interpretation-of-results" id="toc-summary-and-interpretation-of-results" class="nav-link" data-scroll-target="#summary-and-interpretation-of-results">Summary and Interpretation of Results</a>
  <ul class="collapse">
  <li><a href="#validation-and-discussion" id="toc-validation-and-discussion" class="nav-link" data-scroll-target="#validation-and-discussion">Validation and Discussion</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Unsupervised Learning</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- After digesting the instructions, you can delete this cell, these are assignment instructions and do not need to be included in your final submission.  -->
<!-- {{< include instructions.qmd >}} -->
<section id="introduction-and-motivation" class="level1">
<h1>Introduction and Motivation:</h1>
<p>In this analysis, we aim to identify anomalous trends hidden in the dataset and apply different clustering and dimensionality reduction techniques to our cleaned YouTube video dataset, which includes both textual(topics of video, tages of video, or topic of video) and numerical data(view counts of video, like counts of video, etc.). We calculated the average engagement rate per video by subscribers on YouTube is calculated as the total engagement (likes, comments, and dislikes) divided by the number of videos the profile published<span class="citation" data-cites="socialinsider_engagement_rate"><sup><a href="#ref-socialinsider_engagement_rate" role="doc-biblioref">1</a></sup></span>. The result is then divided by the number of subscribers, and all multiplied by 100. The goal is to gain insights into the underlying structure of the dataset by reducing its high dimensionality and identifying meaningful patterns. We will apply methods such as PCA, t-SNE, K-Means, DBSCAN, and Agglomerative Clustering to understand how each technique performs in capturing the data’s inherent structure. By tuning the hyperparameters and evaluating model performance, we seek to uncover hidden relationships in the data and visualize the results for easier interpretation. This analysis will help us assess the suitability of each method for this particular dataset, guiding future decisions for clustering and dimensionality reduction in more complex datasets.</p>
</section>
<section id="overview-of-methods" class="level1">
<h1>Overview of Methods</h1>
<section id="part1-dimensionality-reduction" class="level4">
<h4 class="anchored" data-anchor-id="part1-dimensionality-reduction">Part1: Dimensionality Reduction</h4>
<ol type="1">
<li><strong>PCA (Principal Component Analysis):</strong>
<ul>
<li><strong>WHAT</strong>: Principal Component Analysis (PCA) is a technique used for dimensionality reduction by transforming data into a set of linearly uncorrelated variables called principal components. PCA projects the original data onto new axes, which capture the maximum variance in the data, making it easier to analyze.<span class="citation" data-cites="gpt4o-pca"><sup><a href="#ref-gpt4o-pca" role="doc-biblioref">2</a></sup></span></li>
<li><strong>WHY</strong>: Our Youtube Video dataset contains high-dimensional data, applying PCA makes it easier to visualize and interpret. Since PCA identifies directions (principal components) in which the data has the most variance, retaining the most important patterns of the data in fewer dimensions, we want to apply it to reduce the dimension of our data input. By eliminating less significant components, PCA can help reduce noise in the data. However, we suspect that PCA would not be most suitable one for our dataset, because PCA assumes linear separability in the data. It may not perform well on data with nonlinear relationships.</li>
<li><strong>HOW</strong>:
<ul>
<li><em>Expected input</em>: The input data, should be a matrix where rows are data points and columns are features.</li>
<li><em>Expected output</em>: The transformed data with reduced dimensions. It will have fewer columns than the original dataset, corresponding to the principal components that capture the most variance in the data.</li>
<li><em>Expected parameter</em>: We will tuned the hyperparameters iteratively to find the optimal number of components that explain the maximum variance in the data. The best value is selected based on the cumulative explained variance ratio.</li>
</ul></li>
</ul></li>
<li><strong>t-SNE (t-Distributed Stochastic Neighbor Embedding):</strong>
<ul>
<li><strong>WHAT</strong>: t-SNE is a nonlinear dimensionality reduction technique primarily used for visualizing high-dimensional datasets. Unlike PCA, t-SNE focuses on preserving local structures by minimizing the divergence between probability distributions that represent pairwise similarities in the high-dimensional space and the corresponding low-dimensional representation. It is commonly used to visualize data with complex patterns or clusters that may not be captured by linear methods.<span class="citation" data-cites="gpt4o-tsne"><sup><a href="#ref-gpt4o-tsne" role="doc-biblioref">3</a></sup></span></li>
<li><strong>WHY</strong>: Our YouTube Video dataset contains both textual and numerical data with complex relationships, so the relationship between feature are most likely non-linear. Since t-SNE is designed to preserve local structures and reveal clusters that might be hidden in high-dimensional space, it fits well for this dataset. By reducing the dimensionality, we would expect t-SNE allows for better visualization of the relationships between data points.</li>
<li><strong>HOW</strong>:
<ul>
<li><em>Expected input</em>: The input data should be a high-dimensional matrix, where each row represents a data point, and columns represent features. The data could include numerical features, as well as features transformed from text (e.g., using TF-IDF vectorization).</li>
<li><em>Expected output</em>: The transformed data will be in a lower-dimensional space, suitable for visualization. Each point in the new space represents the original data, with similar points being close together, making patterns or clusters more evident.</li>
<li><em>Expected parameter</em>: The primary parameter to tune in t-SNE is <strong>perplexity</strong>, which influences the balance between local and global aspects of the data. The optimal perplexity value is selected by iterating through a range of values and evaluating the resulting t-SNE output based on metrics such as KL divergence.</li>
</ul></li>
</ul></li>
</ol>
</section>
<section id="part-2-clustering" class="level4">
<h4 class="anchored" data-anchor-id="part-2-clustering">Part 2: Clustering</h4>
<ol type="1">
<li><strong>Agglomerative Clustering</strong> is a hierarchical clustering method that builds a cluster tree (dendrogram) from the bottom up. It starts with each data point as its own cluster and iteratively merges the closest clusters until all points belong to a single cluster or until a predefined number of clusters is reached.
<ul>
<li><strong>Why</strong>: Our YouTube video dataset contains both textual and numerical data, so we believe that using Agglomerative Clustering will provide more flexibility in capturing complex cluster shapes compared to other methods like K-Means. Additionally, since we don’t have predefined labels in our dataset, Agglomerative Clustering is a suitable choice because it doesn’t require the number of clusters to be specified beforehand.</li>
<li>This flexibility makes it a useful tool for analyzing the diverse nature of the YouTube video data, which may exhibit non-spherical cluster shapes that other methods like K-Means may struggle to identify.</li>
</ul></li>
<li><strong>BIRCH (Balanced Iterative Reducing and Clustering using Hierarchies)</strong> is a clustering algorithm designed for large datasets. It combines hierarchical clustering with the construction of CF (Clustering Feature) trees and iterative refinement to handle large-scale data efficiently.
<ul>
<li><strong>Why</strong>: Our YouTube video dataset is relatively large, containing 2204 rows of video data. Therefore, BIRCH is well-suited to handle the size of our dataset, providing both efficient memory usage and scalable performance. By reducing the dimensionality and clustering in an incremental manner, BIRCH efficiently manages large data volumes without overwhelming system resources, making it an ideal choice for our project’s scale.</li>
<li>Moreover, BIRCH’s ability to handle large datasets while maintaining high performance ensures that it can produce meaningful cluster patterns without excessive computational overhead.</li>
</ul></li>
<li><strong>K-Means</strong> is one of the most widely used and simple clustering algorithms. It randomly selects <em>K</em> initial centroids, assigns points to clusters based on the distance to the centroids, and updates the centroids by recalculating the mean of the points in each cluster. The algorithm partitions the data into a predefined number of clusters while minimizing the variance within each cluster.
<ul>
<li><strong>Why</strong>: We included K-Means as a clustering method because it is computationally efficient, with a time complexity of O(n * K * i), where <em>n</em> is the number of points, <em>K</em> is the number of clusters, and <em>i</em> is the number of iterations. K-Means scales well to large datasets, and it is easy to implement and understand.</li>
<li>We will tune the number of clusters by calculating the silhouette score to determine the optimal <em>K</em>, which also helps mitigate the sensitivity to outliers and the initial placement of centroids.</li>
</ul></li>
<li><strong>DBSCAN (Density-Based Spatial Clustering of Applications with Noise)</strong> is a density-based clustering algorithm that groups points based on their proximity and a minimum number of points required in the neighborhood. It can detect arbitrarily shaped clusters and is particularly effective at identifying outliers—points that do not belong to any cluster.
<ul>
<li><strong>Why</strong>: Before applying dimensionality reduction and clustering, we transformed our textual data (e.g., video topics, tags) into numerical values using TF-IDF vectorization and scaled the preprocessed data with StandardScaler. Since DBSCAN does not require specifying the number of clusters in advance, it aligns well with our dataset, which lacks labels.</li>
<li>Being density-based, DBSCAN can detect clusters of any shape, offering greater flexibility than K-Means. It is also effective at identifying outliers, which are assigned to no cluster, making it a good choice for handling noise in the YouTube dataset.</li>
</ul></li>
</ol>
</section>
</section>
<section id="code" class="level1">
<h1>Code</h1>
<p>Providing the source code used for this section of the project here.</p>
<div id="cell-6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn.cluster</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, MinMaxScaler</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn.cluster <span class="im">as</span> skcluster</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-7" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"../../data/processed-data/cleaned_data.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">video_id</th>
<th data-quarto-table-cell-role="th">channelTitle</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">tags</th>
<th data-quarto-table-cell-role="th">publishedAt</th>
<th data-quarto-table-cell-role="th">viewCount</th>
<th data-quarto-table-cell-role="th">likeCount</th>
<th data-quarto-table-cell-role="th">dislikeCount</th>
<th data-quarto-table-cell-role="th">favoriteCount</th>
<th data-quarto-table-cell-role="th">commentCount</th>
<th data-quarto-table-cell-role="th">duration</th>
<th data-quarto-table-cell-role="th">definition</th>
<th data-quarto-table-cell-role="th">caption</th>
<th data-quarto-table-cell-role="th">topicCategories</th>
<th data-quarto-table-cell-role="th">popularity</th>
<th data-quarto-table-cell-role="th">popularity_multi_class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>b6FTKe-u8XI</td>
<td>Richard Restatement</td>
<td>Can I get scout badgetherookie viralvideo fory...</td>
<td>NaN</td>
<td>2024-11-20T22:42:00Z</td>
<td>0.049597</td>
<td>0.139295</td>
<td>NaN</td>
<td>0</td>
<td>0.009236</td>
<td>59</td>
<td>hd</td>
<td>False</td>
<td>Entertainment Film</td>
<td>high</td>
<td>high</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>W_19sjpQttw</td>
<td>Succesful Celebrity</td>
<td>Bill Nye The Science Guy Shows Kai Cenat A Sci...</td>
<td>kai cenat kai cenat imkaicenat amp kai cenat l...</td>
<td>2024-11-17T17:01:47Z</td>
<td>0.082768</td>
<td>0.193623</td>
<td>NaN</td>
<td>0</td>
<td>0.033605</td>
<td>26</td>
<td>hd</td>
<td>False</td>
<td>Entertainment Film Television_program</td>
<td>high</td>
<td>high</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>udVz8GN_DP0</td>
<td>Kieran Ta</td>
<td>Youre not gonna hit me again are you supernatu...</td>
<td>NaN</td>
<td>2024-11-18T03:13:34Z</td>
<td>0.045601</td>
<td>0.105196</td>
<td>NaN</td>
<td>0</td>
<td>0.007719</td>
<td>58</td>
<td>hd</td>
<td>False</td>
<td>Entertainment Film Television_program</td>
<td>high</td>
<td>high</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>iOecn1gSBZY</td>
<td>M2M Heart</td>
<td>Open the cash with moneyThis is funniest robbe...</td>
<td>NaN</td>
<td>2024-11-16T13:00:53Z</td>
<td>0.070301</td>
<td>0.179141</td>
<td>NaN</td>
<td>0</td>
<td>0.013535</td>
<td>59</td>
<td>hd</td>
<td>False</td>
<td>Entertainment Film</td>
<td>high</td>
<td>high</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>u1IuChCXplQ</td>
<td>9-1-1 house</td>
<td>He realized that they did not stop death</td>
<td>NaN</td>
<td>2024-11-20T19:52:08Z</td>
<td>0.032618</td>
<td>0.069746</td>
<td>NaN</td>
<td>0</td>
<td>0.007707</td>
<td>60</td>
<td>hd</td>
<td>False</td>
<td>Entertainment Film</td>
<td>high</td>
<td>high</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-8" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"dislikeCount"</span>] <span class="op">=</span> data[<span class="st">"dislikeCount"</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"favoriteCount"</span>] <span class="op">=</span> data[<span class="st">"favoriteCount"</span>].astype(<span class="bu">float</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"duration"</span>] <span class="op">=</span> data[<span class="st">"duration"</span>].astype(<span class="bu">int</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'topicCategories'</span>] <span class="op">=</span> data[<span class="st">'topicCategories'</span>].fillna(<span class="st">''</span>)  <span class="co"># Handle NaN values</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'tags'</span>] <span class="op">=</span> data[<span class="st">'tags'</span>].fillna(<span class="st">''</span>)  <span class="co"># Handle NaN values</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'engagement_rate'</span>] <span class="op">=</span> (data[<span class="st">"likeCount"</span>] <span class="op">+</span> data[<span class="st">"dislikeCount"</span>] <span class="op">+</span> data[<span class="st">"favoriteCount"</span>] <span class="op">+</span> data[<span class="st">"commentCount"</span>]) <span class="op">/</span> data[<span class="st">"viewCount"</span>]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data[[<span class="st">'title'</span>, <span class="st">'tags'</span>, <span class="st">'viewCount'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>       <span class="st">'likeCount'</span>, <span class="st">'dislikeCount'</span>, <span class="st">'favoriteCount'</span>, <span class="st">'commentCount'</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>       <span class="st">'duration'</span>, <span class="st">'topicCategories'</span>, <span class="st">'engagement_rate'</span>]]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>data.dropna(axis<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cate_trans <span class="op">=</span> TfidfVectorizer(stop_words<span class="op">=</span><span class="st">"english"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>trans_titles <span class="op">=</span> cate_trans.fit_transform(data[<span class="st">"title"</span>]).toarray()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>trans_tags <span class="op">=</span> cate_trans.fit_transform(data[<span class="st">"tags"</span>]).toarray()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>trans_topics <span class="op">=</span> cate_trans.fit_transform(data[<span class="st">"topicCategories"</span>]).toarray()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data_subset<span class="op">=</span>data[[<span class="st">'viewCount'</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'likeCount'</span>, <span class="st">'dislikeCount'</span>, <span class="st">'favoriteCount'</span>, <span class="st">'commentCount'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'duration'</span>, <span class="st">'engagement_rate'</span>]]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>data_subset <span class="op">=</span> data_subset.replace([np.inf, <span class="op">-</span>np.inf], np.nan).fillna(<span class="dv">0</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>scaled_numerical_features <span class="op">=</span> scaler.fit_transform(data_subset)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>scaled_titles <span class="op">=</span> scaler.fit_transform(trans_titles)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>scaled_tags <span class="op">=</span> scaler.fit_transform(trans_tags)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>scaled_topics <span class="op">=</span> scaler.fit_transform(trans_topics)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>combined_features <span class="op">=</span> np.hstack((scaled_numerical_features, scaled_titles, scaled_tags, scaled_topics))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>combined_features.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>(2130, 14131)</code></pre>
</div>
</div>
<section id="part-1-dimensionality-reduction" class="level2">
<h2 class="anchored" data-anchor-id="part-1-dimensionality-reduction">Part 1: Dimensionality Reduction</h2>
<ol type="1">
<li><p><strong>PCA (Principal Component Analysis):</strong></p></li>
<li><p><strong>t-SNE (t-distributed Stochastic Neighbor Embedding):</strong></p></li>
<li><p><strong>Evaluation and Comparison:</strong></p></li>
</ol>
<div id="cell-12" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dimensionality_reduction(X, method<span class="op">=</span><span class="st">"pca"</span>):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Dimensionality reduction with PCA or t-SNE, includes hyperparameter tuning.</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Raises:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">        ValueError: if providing unsupported dimension reduction method name</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">        _type_: data has dimension reduced</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method.lower() <span class="op">==</span> <span class="st">"pca"</span>:</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        best_n_component <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        best_var <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Tuning PCA number of components..."</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">50</span>, <span class="dv">5</span>):</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>            pca <span class="op">=</span> PCA(n_components<span class="op">=</span>n)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>            X_pca <span class="op">=</span> pca.fit_transform(X)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>            exp_var <span class="op">=</span> np.cumsum(pca.explained_variance_ratio_)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Number of componenets: </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">, Explained Variance Ratio: </span><span class="sc">{</span>exp_var[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> exp_var[<span class="op">-</span><span class="dv">1</span>] <span class="op">&gt;</span> best_var:  <span class="co"># Compare the last cumulative variance</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                best_n_component <span class="op">=</span> n</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>                best_var <span class="op">=</span> exp_var[<span class="op">-</span><span class="dv">1</span>]  <span class="co"># Update best variance</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        pca <span class="op">=</span> PCA(n_components<span class="op">=</span>best_n_component)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        X_pca <span class="op">=</span> pca.fit_transform(X)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Best number of components: </span><span class="sc">{</span>best_n_component<span class="sc">}</span><span class="ss">, Explained Variance Ratio: </span><span class="sc">{</span>best_var<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> X_pca</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> method.lower() <span class="op">==</span> <span class="st">"tsne"</span>:</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        best_perplexity <span class="op">=</span> <span class="va">None</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        best_kl_divergence <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        tuned_tsne <span class="op">=</span> <span class="va">None</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Tuning t-SNE perplexity..."</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> perplexity <span class="kw">in</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">50</span>]:</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>            tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>, perplexity<span class="op">=</span>perplexity, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>            X_transformed <span class="op">=</span> tsne.fit_transform(X)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>            kl_divergence <span class="op">=</span> tsne.kl_divergence_</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Perplexity: </span><span class="sc">{</span>perplexity<span class="sc">}</span><span class="ss">, KL Divergence: </span><span class="sc">{</span>kl_divergence<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> kl_divergence <span class="op">&lt;</span> best_kl_divergence:</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>                best_kl_divergence <span class="op">=</span> kl_divergence</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>                best_perplexity <span class="op">=</span> perplexity</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>                tuned_tsne <span class="op">=</span> X_transformed</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Best Perplexity: </span><span class="sc">{</span>best_perplexity<span class="sc">}</span><span class="ss">, Best KL Divergence: </span><span class="sc">{</span>best_kl_divergence<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> tuned_tsne</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Unsupported dimensionality reduction method."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-13" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x_raw_pca <span class="op">=</span> dimensionality_reduction(combined_features, method<span class="op">=</span><span class="st">"PCA"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>x_raw_tsne <span class="op">=</span> dimensionality_reduction(combined_features, method<span class="op">=</span><span class="st">"TSNE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tuning PCA number of components...
Number of componenets: 2, Explained Variance Ratio: 0.007621356137330164
Number of componenets: 7, Explained Variance Ratio: 0.023568496533213433
Number of componenets: 12, Explained Variance Ratio: 0.03691464799856191
Number of componenets: 17, Explained Variance Ratio: 0.04850314466749101
Number of componenets: 22, Explained Variance Ratio: 0.059166877699340335
Number of componenets: 27, Explained Variance Ratio: 0.06940027107590181
Number of componenets: 32, Explained Variance Ratio: 0.07933031287387941
Number of componenets: 37, Explained Variance Ratio: 0.08902957786542476
Number of componenets: 42, Explained Variance Ratio: 0.0984258666124817
Number of componenets: 47, Explained Variance Ratio: 0.10750359448628671
Best number of components: 47, Explained Variance Ratio: 0.10750359448628671
Tuning t-SNE perplexity...
Perplexity: 5, KL Divergence: 5.56992769241333
Perplexity: 10, KL Divergence: 4.418832302093506
Perplexity: 30, KL Divergence: 3.3578200340270996
Perplexity: 50, KL Divergence: 2.8662688732147217
Best Perplexity: 50, Best KL Divergence: 2.8662688732147217</code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a figure with two subplots side by side</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))  <span class="co"># 1 row, 2 columns</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># First scatter plot</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ax1.scatter(x_raw_pca[:,<span class="dv">0</span>], x_raw_pca[:,<span class="dv">1</span>], color<span class="op">=</span><span class="st">'blue'</span>)  </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>ax1.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Dimension1'</span>, ylabel<span class="op">=</span><span class="st">'Dimension2'</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'PCA'</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Second scatter plot</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>ax2.scatter(x_raw_tsne[:,<span class="dv">0</span>], x_raw_tsne[:,<span class="dv">1</span>], color<span class="op">=</span><span class="st">'green'</span>)  </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>ax2.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Dimension1'</span>, ylabel<span class="op">=</span><span class="st">'Dimension2'</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>ax2.grid()</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'TSNE'</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust layout to avoid overlap</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plots</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>By placing the scatter plots of PCA and t-SNE side by side, we can see that the PCA scatter plot only shows three clusters visiblely. The reason for this is the linear nature of PCA, which assumes that the data’s primary patterns can be captured by linear combinations of the features.</p>
<p>This finding aligns with our assumption: if the data contains nonlinear relationships, PCA may not fully represent its structure, leading to a less informative visualization. Additionally, feature scaling could affect the outcome. In contrast, t-SNE excels at capturing nonlinear relationships, which is why its visualization shows a more meaningful, circular pattern. The flexibility of t-SNE allows it to reveal complex clustering structures that PCA might miss.</p>
</section>
<section id="part-2-clustering-methods" class="level2">
<h2 class="anchored" data-anchor-id="part-2-clustering-methods">Part 2: Clustering Methods</h2>
<p>Apply clustering techniques (K-Means, DBSCAN, and Hierarchical clustering) to a selected dataset.</p>
<ol type="1">
<li><p><strong>Clustering Methods</strong></p>
<ul>
<li>Apply <strong>K-Means</strong>, <strong>DBSCAN</strong>, and <strong>Hierarchical clustering</strong> to dataset.</li>
</ul></li>
<li><p><strong>Results Section</strong></p></li>
<li><p><strong>Conclusion</strong></p></li>
</ol>
<div id="cell-17" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_2D(X,color_vector, modelName):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Draw 2D scatter plots for data and predicted labels</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">        X (array): data</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">        color_vector (array): predicted labels</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">        modelName (str): title on the plot</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    ax.scatter(X[:,<span class="dv">0</span>], X[:,<span class="dv">1</span>],c<span class="op">=</span>color_vector, cmap<span class="op">=</span><span class="st">'viridis'</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)  </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Dimension1'</span>, ylabel<span class="op">=</span><span class="st">'Dimension2'</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>modelName<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    ax.grid()</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_optimal_clustering(X, algo<span class="op">=</span><span class="st">"kmeans"</span>, nmax<span class="op">=</span><span class="dv">20</span>):</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate the optimal clustering parameter and labels based on silhouette scores.</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">        X (array-like): Input data for clustering.</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">        algo (str): Clustering algorithm ("birch", "ag", "dbscan", "kmeans").</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">        nmax (int): Maximum range for hyperparameter tuning.</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">        tuple: Optimal parameter, labels, and silhouette scores for each parameter.</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure `X` is contiguous</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># X = X.toarray()</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize variables</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> []</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    sil_scores <span class="op">=</span> []</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    sil_max <span class="op">=</span> <span class="op">-</span><span class="dv">10</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    opt_param <span class="op">=</span> <span class="va">None</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    opt_labels <span class="op">=</span> <span class="va">None</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, nmax <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> algo.lower() <span class="op">==</span> <span class="st">"birch"</span>:</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> skcluster.Birch(n_clusters<span class="op">=</span>p)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>            pred_labels <span class="op">=</span> model.fit_predict(X)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> algo.lower() <span class="op">==</span> <span class="st">"ag"</span>:</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> skcluster.AgglomerativeClustering(n_clusters<span class="op">=</span>p)</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>            pred_labels <span class="op">=</span> model.fit_predict(X)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> algo.lower() <span class="op">==</span> <span class="st">"dbscan"</span>:</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>            eps <span class="op">=</span> p <span class="op">*</span> <span class="fl">0.25</span>  <span class="co"># Adjust `eps` for DBSCAN</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> skcluster.DBSCAN(eps<span class="op">=</span>eps, min_samples<span class="op">=</span><span class="dv">2</span>) </span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>            pred_labels <span class="op">=</span> model.fit_predict(X)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> algo.lower() <span class="op">==</span> <span class="st">"kmeans"</span>:</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> skcluster.KMeans(n_clusters<span class="op">=</span>p, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>            pred_labels <span class="op">=</span> model.fit_predict(X)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Unsupported clustering algorithm."</span>)</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute silhouette score</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>: </span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>            sil_score <span class="op">=</span> silhouette_score(X, pred_labels)</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>            sil_scores.append(sil_score)</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>            params.append(p)</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> sil_score <span class="op">&gt;=</span> sil_max:</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>            sil_max <span class="op">=</span> sil_score</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>            opt_param <span class="op">=</span> p</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>            opt_labels <span class="op">=</span> pred_labels</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> sil_scores:</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"No valid silhouette scores found. Ensure your data and parameters are suitable for clustering."</span>)</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> opt_param, opt_labels, params, sil_scores</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_silhouette_scores(params, sil_scores, algo):</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a><span class="co">    Plot silhouette scores against clustering parameters.</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a><span class="co">        params (list): List of clustering parameters.</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a><span class="co">        sil_scores (list): Corresponding silhouette scores for each parameter.</span></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a><span class="co">        algo (str): Clustering algorithm name (for title).</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a><span class="co">    a line plot of Silhouette Score in different parameter values</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>    plt.plot(params, sil_scores, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Silhouette Score"</span>)</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>    plt.xlim(<span class="dv">1</span>, <span class="bu">max</span>(params) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Parameter"</span>)</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Silhouette Score"</span>)</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f"Silhouette Scores for </span><span class="sc">{</span>algo<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss"> Clustering"</span>)</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>    plt.grid()</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-18" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pca_X <span class="op">=</span> dimensionality_reduction(combined_features, method<span class="op">=</span><span class="st">"pca"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>opt_param, opt_labels, params, sil_scores <span class="op">=</span> calculate_optimal_clustering(pca_X, algo<span class="op">=</span><span class="st">"kmeans"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plot_silhouette_scores(params, sil_scores, algo<span class="op">=</span><span class="st">"kmeans"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal Parameter:"</span>, opt_param)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of Optimal Labels: "</span>, <span class="bu">len</span>(opt_labels))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plot_2D(pca_X, opt_labels, <span class="st">"Kmeans"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tuning PCA number of components...
Number of componenets: 2, Explained Variance Ratio: 0.007622876451205808
Number of componenets: 7, Explained Variance Ratio: 0.02356908405705091
Number of componenets: 12, Explained Variance Ratio: 0.036920049979048984
Number of componenets: 17, Explained Variance Ratio: 0.04855698535454517
Number of componenets: 22, Explained Variance Ratio: 0.05915508579096912
Number of componenets: 27, Explained Variance Ratio: 0.06930950728830565
Number of componenets: 32, Explained Variance Ratio: 0.07930831947846977
Number of componenets: 37, Explained Variance Ratio: 0.08905551489624212
Number of componenets: 42, Explained Variance Ratio: 0.09837550758343419
Number of componenets: 47, Explained Variance Ratio: 0.10756753880097233
Best number of components: 47, Explained Variance Ratio: 0.10756753880097233</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-11-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Parameter: 2
Number of Optimal Labels:  2130</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-11-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We tuned the number of components to fit PCA based on explained variance ratio and select 47 as the best parameter, which indicates it captures 10% of the variance in the dataset. Despite this relatively low explained variance, the K-Means clustering model identified 2 optimal clusters based on silhouette scores, with the PCA-transformed data. This means that K-Means effectively groups the 2130 data points into 2 clusters, although the PCA reduction retains only a portion of the total variance. The results suggest that PCA may not fully capture the complexity of the dataset.</p>
<div id="cell-20" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tsne_X <span class="op">=</span> dimensionality_reduction(combined_features, method<span class="op">=</span><span class="st">"tsne"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>opt_param, opt_labels, params, sil_scores <span class="op">=</span> calculate_optimal_clustering(tsne_X, algo<span class="op">=</span><span class="st">"kmeans"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plot_silhouette_scores(params, sil_scores, algo<span class="op">=</span><span class="st">"kmeans"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal Parameter:"</span>, opt_param)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of Optimal Labels: "</span>, <span class="bu">len</span>(opt_labels))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plot_2D(tsne_X, opt_labels, <span class="st">"Kmeans"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tuning t-SNE perplexity...
Perplexity: 5, KL Divergence: 5.56992769241333
Perplexity: 10, KL Divergence: 4.418832302093506
Perplexity: 30, KL Divergence: 3.3578200340270996
Perplexity: 50, KL Divergence: 2.8662688732147217
Best Perplexity: 50, Best KL Divergence: 2.8662688732147217</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-12-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Parameter: 7
Number of Optimal Labels:  2130</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-12-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We tuned the value of perplexity to fit TSNE based on KL divergence score and received 50 as the best value of perplexity, which has the lowest difference between the pairwise similarities in the original high-dimensional space and the pairwise similarities in the lower-dimensional space after transformation. The Kmeans clustering model identified 7 optimal clusters based on silhouette scores, with the TSNE-transformed data. This means that K-Means effectively groups the 2130 data points into 7 clusters. The distribution of data points on the second scatter plot suggests that TSNE successfully captures the complexity of the dataset.</p>
<div id="cell-22" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>opt_param, opt_labels, params, sil_scores <span class="op">=</span> calculate_optimal_clustering(tsne_X, algo<span class="op">=</span><span class="st">"dbscan"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>plot_silhouette_scores(params, sil_scores, algo<span class="op">=</span><span class="st">"dbscan"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal Parameter:"</span>, opt_param)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of Optimal Labels: "</span>, <span class="bu">len</span>(opt_labels))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>plot_2D(tsne_X, opt_labels, <span class="st">"DBSCAN"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Parameter: 2
Number of Optimal Labels:  2130</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-13-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the section above, we applied t-SNE with a perplexity of 50 to reduce the dimensionality of the same dataset. Using the t-SNE-transformed data, the DBSCAN clustering model identified 2 optimal clusters based on silhouette scores. This means DBSCAN grouped the 2130 data points into 2 clusters.</p>
<p>However, the scatter plot suggests that DBSCAN visually separates the data into three groups based on color. The separation appears less effective compared to the results achieved with K-Means, which provided clearer and more distinct clusters.</p>
<div id="cell-24" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>opt_param, opt_labels, params, sil_scores <span class="op">=</span> calculate_optimal_clustering(tsne_X, algo<span class="op">=</span><span class="st">"AG"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plot_silhouette_scores(params, sil_scores, algo<span class="op">=</span><span class="st">"AG"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal Parameter:"</span>, opt_param)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of Optimal Labels: "</span>, <span class="bu">len</span>(opt_labels))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plot_2D(tsne_X, opt_labels, <span class="st">"Agglomerative Clustering"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Parameter: 6
Number of Optimal Labels:  2130</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-14-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the section above, we applied t-SNE with a perplexity of 50 to reduce the dimensionality of the dataset. Using the t-SNE-transformed data, the Agglomerative Clustering model identified 6 optimal clusters based on silhouette scores. This result suggests that Agglomerative Clustering effectively groups the 2130 data points into 6 clusters, capturing some patterns within the dataset. The scatter plot further highlights how t-SNE successfully captures the complexity and nonlinear structure of the data, enabling meaningful clustering.</p>
<div id="cell-26" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>opt_param, opt_labels, params, sil_scores <span class="op">=</span> calculate_optimal_clustering(tsne_X, algo<span class="op">=</span><span class="st">"BIRCH"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>plot_silhouette_scores(params, sil_scores, algo<span class="op">=</span><span class="st">"BIRCH"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal Parameter:"</span>, opt_param)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of Optimal Labels: "</span>, <span class="bu">len</span>(opt_labels))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>plot_2D(tsne_X, opt_labels, <span class="st">"BIRCH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal Parameter: 8
Number of Optimal Labels:  2130</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-15-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the section above, we applied t-SNE with a perplexity of 50 to reduce the dimensionality of the dataset. Using the t-SNE-transformed data, the BIRCH (Balanced Iterative Reducing and Clustering using Hierarchies) model identified 8 optimal clusters based on silhouette scores. This result indicates that BIRCH effectively groups the 2130 data points into 8 clusters, capturing key patterns within the dataset.</p>
<p>The scatter plot illustrates that t-SNE successfully captures the dataset’s complexity and nonlinear relationships, enabling meaningful clustering. When compared to the clustering results from K-Means, the outcomes are notably similar. This similarity can be attributed to BIRCH’s approach of recursively compressing the data into a CF (Clustering Feature) tree and performing clustering on the summarized clusters, which can align well with the results of K-Means under certain data structures.</p>
</section>
</section>
<section id="summary-and-interpretation-of-results" class="level1">
<h1>Summary and Interpretation of Results</h1>
<p>Our analysis involved applying dimensionality reduction techniques (PCA and t-SNE) followed by clustering methods (K-Means, Agglomerative Clustering, DBSCAN, and BIRCH) to a dataset of 2130 data points. Each approach offered unique insights into the structure and complexity of the data.</p>
<section id="key-findings" class="level4">
<h4 class="anchored" data-anchor-id="key-findings">Key Findings:</h4>
<p><strong>PCA Analysis:</strong></p>
<ul>
<li>PCA identified 47 components as optimal, explaining only around 10% of the dataset’s variance. This result highlights PCA’s limitation in representing data with nonlinear relationships, as the scatter plot revealed sparse clusters with limited separability.</li>
</ul>
<p><strong>t-SNE Analysis:</strong></p>
<ul>
<li>t-SNE, with a perplexity of 50, produced a dense and meaningful circular visualization, capturing the dataset’s nonlinear patterns more effectively than PCA. The t-SNE-transformed data formed the foundation for more nuanced clustering.</li>
</ul>
<p>The side by side visuals of PCA and T-SNE: t-SNE shows tightly packed clusters, which suggests the data is well-separated. Overlapping clusters in PCA suggests the need for nonlinear methods. The scatter plot help us to find the most suitable dimension reduction metric as T-SNE.</p>
</section>
<section id="clustering-results" class="level4">
<h4 class="anchored" data-anchor-id="clustering-results">Clustering Results:</h4>
<ul>
<li><strong>K-Means</strong>: Identified 2 optimal clusters for PCA-transformed data and 7 clusters for t-SNE-transformed data, producing well-separated groupings. This highlights K-Means’ effectiveness in capturing both linear and nonlinear patterns, especially in t-SNE space.</li>
<li><strong>DBSCAN</strong>: Detected 2 clusters for t-SNE data but exhibited less effective separation compared to K-Means, likely due to its sensitivity to noise and density thresholds.</li>
<li><strong>Agglomerative Clustering</strong>: Identified 6 clusters for t-SNE data, capturing local distribution patterns.<br>
</li>
<li><strong>BIRCH</strong>: Found 8 clusters for t-SNE data, aligning closely with K-Means results, leveraging its CF-tree structure to summarize and cluster effectively.</li>
</ul>
<p>Considering the theoretical background of the four clustering methods and their results in terms of the number of clusters, we can draw technical implications from the dataset:</p>
<ul>
<li><p><strong>Number of Clusters</strong>: The number of clusters identified by K-Means, Agglomerative Clustering and BIRCH is around 7, suggesting that based on the attributes of the videos, they could be separated into approximately 7 clusters based on their similarities. DBSCAN identifies fewer clusters compared to K-Means, which may indicate the presence of noise or outliers in the data.</p></li>
<li><p><strong>Cluster Sizes</strong>: The clustering visualizations show that the sizes of clusters in three of the models (Agglomerative Clustering, BIRCH, and K-Means) are quite similar, suggesting a balance of data within each cluster. However, some points deviate from the cluster center, indicating the presence of outliers.</p></li>
<li><p><strong>Cluster Overlaps</strong>: From the clustering outputs of the four models (Agglomerative Clustering, BIRCH, K-Means, DBSCAN), we can see that while some data points are spread out or concentrated, the clusters usually do not overlap. This trend suggests clear segmentation within the data.</p></li>
<li><p><strong>Outliers and Noise</strong>: The plot of DBSCAN marks noise points that do not belong to any cluster. The data sparsity in the other three models suggests the presence of noise and the need for better preprocessing. Considering our case of analyzing YouTube video prevalence and factors leading to video popularity, we believe these outliers or noise points may correspond to viral or exceptional videos on YouTube.</p></li>
</ul>
</section>
<section id="validation-and-discussion" class="level3">
<h3 class="anchored" data-anchor-id="validation-and-discussion">Validation and Discussion</h3>
<p>By inserting the predicted labels into the original dataset and analyzing the statistical distribution of features such as viewCount, likeCount, and commentCount by cluster label, along with generating word clouds for video topics in two of the clusters, we observe both overlaps and distinctions among the video clusters.</p>
<p>The overlaps arise because videos often share similar content themes, such as games, culture, and entertainment. However, the word clouds reveal clear differences between clusters. For instance, the word cloud for Cluster 1 prominently features terms like “Sports,” “Football,” and “Boxing,” indicating a strong focus on sports-related content. In contrast, the word cloud for Cluster 2 includes terms such as “Music,” “Film,” and “Pop,” suggesting that it primarily contains videos about arts and entertainment.</p>
<p>These findings answer our data science research question and demonstrate that while some clusters share overlapping themes, there are still distinguishable differences that provide valuable insights into the thematic focus of video content.</p>
<div id="cell-33" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data_subset[<span class="st">'cluster_label'</span>] <span class="op">=</span> opt_labels</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting relevant columns for the bar chart</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> [<span class="st">"viewCount"</span>, <span class="st">"likeCount"</span>,  <span class="st">"commentCount"</span>]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>statistics <span class="op">=</span> data_subset.groupby(<span class="st">"cluster_label"</span>)[metrics].agg([<span class="st">"mean"</span>, <span class="st">"median"</span>,  <span class="st">"min"</span>, <span class="st">"max"</span>])</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>statistics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="4" data-quarto-table-cell-role="th" data-halign="left">viewCount</th>
<th colspan="4" data-quarto-table-cell-role="th" data-halign="left">likeCount</th>
<th colspan="4" data-quarto-table-cell-role="th" data-halign="left">commentCount</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">median</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">median</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">median</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">cluster_label</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.013866</td>
<td>0.004096</td>
<td>0.000016</td>
<td>0.423685</td>
<td>0.021536</td>
<td>0.005198</td>
<td>0.000067</td>
<td>0.468005</td>
<td>0.014446</td>
<td>0.006101</td>
<td>0.000000</td>
<td>0.596794</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.013806</td>
<td>0.006373</td>
<td>0.000030</td>
<td>0.477195</td>
<td>0.023806</td>
<td>0.009477</td>
<td>0.000051</td>
<td>0.468545</td>
<td>0.009273</td>
<td>0.004403</td>
<td>0.000000</td>
<td>0.206553</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.010412</td>
<td>0.002316</td>
<td>0.000016</td>
<td>0.308074</td>
<td>0.013670</td>
<td>0.002629</td>
<td>0.000145</td>
<td>0.303857</td>
<td>0.009717</td>
<td>0.005223</td>
<td>0.000301</td>
<td>0.063236</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.029143</td>
<td>0.008379</td>
<td>0.000018</td>
<td>0.533076</td>
<td>0.043907</td>
<td>0.010849</td>
<td>0.000043</td>
<td>0.682176</td>
<td>0.015880</td>
<td>0.007726</td>
<td>0.000037</td>
<td>0.196156</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.003769</td>
<td>0.002196</td>
<td>0.000383</td>
<td>0.017765</td>
<td>0.004585</td>
<td>0.002536</td>
<td>0.000503</td>
<td>0.027301</td>
<td>0.008085</td>
<td>0.004244</td>
<td>0.000405</td>
<td>0.032616</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.019854</td>
<td>0.005016</td>
<td>0.000024</td>
<td>0.183127</td>
<td>0.031322</td>
<td>0.004967</td>
<td>0.000021</td>
<td>0.649047</td>
<td>0.032429</td>
<td>0.007406</td>
<td>0.000111</td>
<td>0.999957</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.013004</td>
<td>0.007085</td>
<td>0.000004</td>
<td>0.080577</td>
<td>0.024154</td>
<td>0.009196</td>
<td>0.000000</td>
<td>0.162264</td>
<td>0.013300</td>
<td>0.006940</td>
<td>0.000000</td>
<td>0.119894</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>0.019693</td>
<td>0.005512</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.030634</td>
<td>0.007939</td>
<td>0.000019</td>
<td>1.000000</td>
<td>0.014550</td>
<td>0.005828</td>
<td>0.000000</td>
<td>0.896355</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"cluster_label"</span>] <span class="op">=</span> opt_labels</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>cluster_1 <span class="op">=</span> data[data[<span class="st">"cluster_label"</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>cluster_3 <span class="op">=</span> data[data[<span class="st">"cluster_label"</span>] <span class="op">==</span> <span class="dv">3</span>]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>topic_data1 <span class="op">=</span> <span class="st">" "</span>.join(cluster_1[<span class="st">'topicCategories'</span>].drop_duplicates()).replace(<span class="st">"_"</span>, <span class="st">" "</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>topic_data3 <span class="op">=</span> <span class="st">" "</span>.join(cluster_3[<span class="st">'topicCategories'</span>].drop_duplicates()).replace(<span class="st">"_"</span>, <span class="st">" "</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the word cloud</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>wordcloud <span class="op">=</span> WordCloud(</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">500</span>, background_color<span class="op">=</span><span class="st">"white"</span>, colormap<span class="op">=</span><span class="st">"viridis"</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>).generate(topic_data1)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the word cloud</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">7</span>))</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud, interpolation<span class="op">=</span><span class="st">"bilinear"</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">"off"</span>)  <span class="co"># Hide axes</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Word Cloud of Cluster 1"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the word cloud</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>wordcloud <span class="op">=</span> WordCloud(</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">500</span>, background_color<span class="op">=</span><span class="st">"white"</span>, colormap<span class="op">=</span><span class="st">"viridis"</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>).generate(topic_data3)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the word cloud</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">7</span>))</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud, interpolation<span class="op">=</span><span class="st">"bilinear"</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">"off"</span>)  <span class="co"># Hide axes</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Word Cloud of Cluster 2"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-17-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-socialinsider_engagement_rate" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Andreea Udescu, S. B. <a href="https://www.socialinsider.io/blog/engagement-rate/#:~:text=The%20average%20engagement%20rate%20per%20video%20by,the%20number%20of%20videos%20the%20profile%20published.&amp;text=To%20calculate%20the%20average%20engagement%20rate%20per,the%20number%20of%20posts%20the%20profile%20published">How to calculate the engagement rate for all social media platforms</a>. (2024).</div>
</div>
<div id="ref-gpt4o-pca" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Prompt: What is PCA. Answered by ChatGPT, version-4o, OpenAI, 2024, chat.openai.com.</div>
</div>
<div id="ref-gpt4o-tsne" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Prompt: What is t-SNE. Answered by ChatGPT, version-4o, OpenAI, 2024, chat.openai.com.</div>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>